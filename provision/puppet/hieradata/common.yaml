---
classes:
  - '::oclubs'

oclubs::secrets:
  encrypt_key: ''
  flask_key: ''
  mariadb_pw: "%{hiera('mysql::server::root_password')}"
  redis_pw: "%{hiera('redis::requirepass')}"
  db2_conn: ''
  sendgrid_key: ''

redis::bind: '127.0.0.1'

mysql::bindings::daemon_dev: true

elasticsearch::java_install: true
elasticsearch::java_package: 'java-1.8.0-openjdk'
elasticsearch::manage_repo: true
elasticsearch::repo_version: '2.x'

selinux::mode: 'permissive'
selinux::type: 'targeted'

python::dev: present
python::virtualenv: present

# Collision
uwsgi::install_pip: false
uwsgi::install_python_dev: false
uwsgi::package_provider: 'yum'
uwsgi::manage_service_file: false
uwsgi::service_provider: 'systemd'

uwsgi::socket: '/var/run/uwsgi/uwsgi-emperor.sock'
uwsgi::emperor_options:
  stats: '/var/run/uwsgi/stats.sock'
  chmod-socket: 660
  uid: 'uwsgi'
  gid: 'nginx'
  cap: 'setgid,setuid'
uwsgi::app:
  oclubs:
    ensure: 'present'
    uid: 'uwsgi'
    gid: 'nginx'
    application_options:
      socket: '/var/run/uwsgi/uwsgi.sock'
      chdir: '/srv/oclubs'
      force-cwd: '/srv/oclubs'
      virtualenv: '/srv/oclubs/venv'
      module: 'oclubs.app:app'
      socket: 'oclubs.app:app'
      master: 'True'
      vaccum: 'True'
      die-on-term: 'True'
      processes: 4
      threads: 2
